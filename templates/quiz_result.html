{% extends "layouts/empty_layout.html" %}
{% block title %}Quiz Result{% endblock title %}
{% block content %}

<div class="d-flex justify-content-center align-items-center px-5">
  <div
    class="quiz-result-card d-flex flex-column justify-content-center align-items-center w-75 p-5 border border-light shadow-lg rounded-5"
  >
    <h1>Quiz Results</h1>
    <br />

    <div id="succes-card">
    <div class="d-flex flex-column align-items-center justify-content-center">
        <div>
        <img id="b-picture" src="/static/images/Check-PNG-File.png" alt="check-icon" />
      </div>
      <p class="text-success fw-bold" id="success-message">Nice job, you passed!</p>
    </div>
    </div>

    <div id="failure-card" style="display:none;">
        <div class="d-flex flex-column align-items-center justify-content-center">
            <div>
            <img id="b-picture" src="/static/images/Red-Cross-Mark-Download-PNG.png" alt="check-icon" />
          </div>
          <p class="text-danger fw-bold" id="failure-message">Sorry, you failed!</p>
        </div>
    </div>

    <div class="row my-4 w-75">
      <div class="col-md-6">
        <div class="score-box d-flex flex-column align-items-center justify-content-center h-100 w-100 border">
          <h5>YOUR SCORE</h5>
          <h1 id="score-table"></h1>
          <div>
            <hr />
            <p class="text-muted" id="passing-score"></p>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div
          class="score-box d-flex flex-column align-items-center justify-content-center h-100 w-100 border"
        >
          <h5>YOUR POINTS</h5>
          <h1 id="point-table"></h1>
          <div>
            <hr />
            <p class="text-muted" id="passing-point"></p>
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex align-items-center justify-content-around w-75">
      <button class="btn btn-primary" onclick="window.location.href = `http://127.0.0.1:5000/`;">Back to Chat</button>
      <button class="btn btn-primary" onclick="window.location.href = `http://127.0.0.1:5000/profile`;">Go to Profile</button>
      <button class="btn btn-primary" onclick="window.location.href = `http://127.0.0.1:5000/quiz_start`;">Review Quiz</button>
      <button id="fai" class="btn btn-primary" onclick="window.location.href = `http://127.0.0.1:5000/quiz_start`;">Retry Quiz</button>
    </div>
    
  </div>
</div>

<script>
    // Sonuçları localStorage'dan al
    const score = localStorage.getItem("quiz_score");
    const point = localStorage.getItem("quiz_point");
    const passed = localStorage.getItem("quiz_passed") === 'true';

    // Sonuçları sayfada güncelle
    document.getElementById("score-table").textContent = `${score}%`;
    document.getElementById("point-table").textContent = `${point}`;

    //passing point ve score dynamic şekilde değişiyor
    const passingScore=70;
    const passingPoint=7;

    document.getElementById("passing-score").textContent = `PASSING SCORE: ${passingScore}%`;
    document.getElementById("passing-point").textContent = `PASSING POINT: ${passingPoint}`;

    if (passed) {
        document.getElementById("succes-card").style.display = "block";
        document.getElementById("failure-card").style.display = "none";
    } else {
        document.getElementById("succes-card").style.display = "none";
        document.getElementById("failure-card").style.display = "block";
    }

    //overwrite olmaması için localStorage'dan verilerin iş bittikten sonra silinmesi lazım
    //alternatif bir yol bulunabilir.
    window.onload = function() {
        setTimeout(() => {
            localStorage.removeItem("quiz_score");
            localStorage.removeItem("quiz_point");
            localStorage.removeItem("quiz_passed");
        }, 1000);
    };

</script>

{% endblock content %}
